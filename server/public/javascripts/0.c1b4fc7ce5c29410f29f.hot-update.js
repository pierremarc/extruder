webpackHotUpdate(0,{

/***/ "./tools.js":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_whatwg_fetch__ = __webpack_require__(\"../node_modules/whatwg-fetch/fetch.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_whatwg_fetch___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_whatwg_fetch__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__lib_ctx_canvas__ = __webpack_require__(\"../lib/ctx-canvas.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__lib_ctx_store__ = __webpack_require__(\"../lib/ctx-store.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__lib_state__ = __webpack_require__(\"../lib/state.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__lib_dom__ = __webpack_require__(\"../lib/dom.js\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__extrude__ = __webpack_require__(\"./extrude.js\");\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = install;\n\n\n\n\n\n\n\n\nfunction fontName(font) {\n    return font.names.fullName.en;\n}\n\nfunction createfontItem(font) {\n    var name = font.names.fontSubfamily.en;\n    var elem = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('div', { class: 'tool-font-item clickable' });\n    elem.addEventListener('click', function () {\n        var nodeList = document.querySelectorAll('.tool-font-item-selected');\n        var selected = Array.prototype.slice.call(nodeList, 0);\n        selected.forEach(function (node) {\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"f\" /* removeClass */])(node, 'tool-font-item-selected');\n        });\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"g\" /* addClass */])(elem, 'tool-font-item-selected');\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__lib_state__[\"b\" /* setState */])('font', font);\n    });\n    var label = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('span');\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"e\" /* appendText */])(label, name);\n    elem.appendChild(label);\n    return elem;\n}\n\nfunction wrapTool(name, fn) {\n    var box = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('div', {\n        class: 'tool tool-' + name\n    });\n    var title = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('div', {\n        class: 'tool-title'\n    });\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"e\" /* appendText */])(title, name);\n    box.appendChild(title);\n\n    for (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n        args[_key - 2] = arguments[_key];\n    }\n\n    fn.apply(undefined, [box].concat(args));\n    return box;\n}\n\nfunction fontTool(box, fonts) {\n    var groups = {};\n    var getGroup = function getGroup(font) {\n        var family = font.names.fontFamily.en;\n        if (!(family in groups)) {\n            var element = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('div', { class: 'font-family' });\n            var title = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('span', { class: 'font-family-title' });\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"e\" /* appendText */])(title, family);\n            element.appendChild(title);\n            box.appendChild(element);\n            groups[family] = element;\n        }\n        return groups[family];\n    };\n    fonts.forEach(function (font) {\n        var fontItem = createfontItem(font);\n        var group = getGroup(font);\n        group.appendChild(fontItem);\n    });\n}\n\nfunction textTool(box) {\n    var textArea = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('textarea', { class: 'tool-text-area' });\n    var text = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__lib_state__[\"c\" /* getState */])('text');\n    textArea.value = text;\n    textArea.addEventListener('keyup', function () {\n        if (textArea.value !== text) {\n            text = textArea.value;\n            __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__lib_state__[\"b\" /* setState */])('text', text);\n        }\n    });\n    box.appendChild(textArea);\n}\n\nfunction exportTool(box) {\n    var knockout = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('input', {\n        type: 'checkbox',\n        value: 'knockout'\n    });\n\n    var exportPNG = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('a', {\n        class: 'tool-export-button',\n        download: 'extruded.png'\n    });\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"e\" /* appendText */])(exportPNG, 'Download PNG');\n\n    var exportPDF = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('a', {\n        class: 'tool-export-button',\n        htref: '#',\n        download: 'extruded.pdf'\n    });\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"e\" /* appendText */])(exportPDF, 'Download PDF');\n\n    box.appendChild(knockout);\n    box.appendChild(exportPNG);\n    box.appendChild(exportPDF);\n\n    var offScreen = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('canvas');\n    var localState = null;\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__lib_state__[\"d\" /* onStateChange */])(function (state) {\n        localState = state;\n    });\n\n    knockout.addEventListener('change', function () {\n        __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__lib_state__[\"b\" /* setState */])('knockout', knockout.checked);\n    });\n\n    exportPNG.addEventListener('mouseenter', function () {\n        if (localState) {\n            offScreen.width = localState.width;\n            offScreen.height = localState.height;\n            var ctx = new __WEBPACK_IMPORTED_MODULE_1__lib_ctx_canvas__[\"a\" /* default */](offScreen);\n            ctx.clear();\n            if (__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_5__extrude__[\"a\" /* default */])(ctx, localState)) {\n                exportPNG.href = offScreen.toDataURL('image/png');\n            }\n        }\n    });\n\n    exportPDF.addEventListener('click', function () {\n        if (localState) {\n            var ctx = new __WEBPACK_IMPORTED_MODULE_2__lib_ctx_store__[\"a\" /* default */]();\n            if (__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_5__extrude__[\"a\" /* default */])(ctx, localState)) {\n                var data = {\n                    width: localState.width,\n                    height: localState.height,\n                    operations: ctx.operations\n                };\n                fetch('/pdf', {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify(data)\n                }).then(function (response) {\n                    return response.blob();\n                }).then(function (blob) {\n                    window.location = URL.createObjectURL(blob);\n                });\n                // exportPDF.href = offScreen.toDataURL('image/png');\n            }\n        }\n    });\n}\n\nfunction install(fonts) {\n    var sidebar = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"b\" /* createElement */])('div', { class: 'tool-box' });\n    var fontBox = wrapTool('font', fontTool, fonts);\n    var textBox = wrapTool('text', textTool);\n    var exportBox = wrapTool('export', exportTool);\n    // const xyBox = wrapTool('xy', xyTool);\n    // const extentBox = wrapTool('size', extentTool);\n\n\n    [textBox, fontBox, exportBox].forEach(function (box) {\n        return sidebar.appendChild(box);\n    });\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__lib_dom__[\"c\" /* body */])().appendChild(sidebar);\n    // body().appendChild(xyBox);\n    // body().appendChild(extentBox);\n}\n\n//////////////////\n// WEBPACK FOOTER\n// ./tools.js\n// module id = ./tools.js\n// module chunks = 0\n\n//# sourceURL=webpack:///./tools.js?");

/***/ })

})